<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Article | Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.js">
            const supabaseUrl = "https://vsoarvrtahsqutzcxnsn.supabase.co"; // Replace with your Supabase URL
      const supabaseKey =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZzb2FydnJ0YWhzcXV0emN4bnNuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgyNTYzMzYsImV4cCI6MjA2MzgzMjMzNn0.s2Y68b1Ssxc4LzkA2J0M3O0jLcL7wpJn_SLyWcNKArM"; // Replace with your Supabase anon key
      const supabase = supabase.createClient(supabaseUrl, supabaseKey);
    </script>
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      body {
        font-family: "Plus Jakarta Sans", sans-serif;
      }
      .card {
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
      }
      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 28px rgba(0, 128, 0, 0.15);
      }
      .fade-in {
        animation: fadeInUp 0.5s ease-out forwards;
        opacity: 0;
        transform: translateY(10px);
      }
      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      button {
        transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
        position: relative;
        overflow: hidden;
      }
      button:hover {
        background-color: #22c55e;
        color: white;
      }
      .ripple {
        position: absolute;
        border-radius: 50%;
        background-color: rgba(255, 255, 255, 0.5);
        transform: scale(0);
        animation: ripple 0.6s linear;
      }
      @keyframes ripple {
        to {
          transform: scale(2);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-green-50 to-white text-gray-800">
    <div id="navbar-placeholder"></div>

    <main class="px-6 md:px-10 py-12 space-y-16">
      <!-- Form Tambah Artikel -->
      <section
        class="max-w-3xl mx-auto bg-white p-6 rounded-xl shadow-md space-y-4 fade-in"
      >
        <h2 class="text-2xl font-semibold text-green-600">Tambah Artikel</h2>
        <input
          type="text"
          id="judul"
          placeholder="Judul Artikel"
          class="w-full border border-gray-300 rounded-lg px-4 py-2"
        />
        <textarea
          id="konten"
          placeholder="Konten Artikel"
          rows="5"
          class="w-full border border-gray-300 rounded-lg px-4 py-2"
        ></textarea>
        <h2 class="text-xl font-semibold text-green-600">
          Masukkan Gambar Artikel
        </h2>
        <input
          type="file"
          id="gambar"
          accept="image/*"
          class="w-full text-sm text-gray-600"
        />
        <button
          onclick="tambahArtikel()"
          class="bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600"
        >
          Simpan Artikel
        </button>
      </section>

      <!-- Daftar Artikel -->
      <section class="max-w-3xl mx-auto space-y-6 fade-in">
        <h2 class="text-2xl font-semibold text-green-600">Daftar Artikel</h2>
        <div id="daftar-artikel" class="space-y-4 text-gray-700"></div>
      </section>
    </main>

    <footer
      class="bg-white border-t border-gray-200 mt-12 py-6 px-6 md:px-10 text-sm text-gray-600 text-center"
    >
      <div class="max-w-screen-xl mx-auto space-y-4">
        <p>
          &copy; 2025 <span class="font-semibold text-green-600">Epicare</span>.
          Semua hak dilindungi.
        </p>
        <div class="flex justify-center flex-wrap gap-4">
          <a href="#" class="hover:text-green-600 transition"
            >Kebijakan Privasi</a
          >
          <a href="#" class="hover:text-green-600 transition"
            >Syarat & Ketentuan</a
          >
          <a href="#" class="hover:text-green-600 transition">Kontak</a>
        </div>
      </div>
    </footer>

    <script>
      // Load Navbar
      fetch("navbar-admin.html")
        .then((res) => res.text())
        .then((html) => {
          document.getElementById("navbar-placeholder").innerHTML = html;
          document
            .getElementById("menu-toggle")
            ?.addEventListener("click", function () {
              document.getElementById("mobile-menu").classList.toggle("hidden");
            });
        });

      // Efek Ripple
      document.addEventListener("click", (e) => {
        if (e.target.tagName === "BUTTON") {
          const button = e.target;
          const circle = document.createElement("span");
          const diameter = Math.max(button.clientWidth, button.clientHeight);
          const radius = diameter / 2;
          circle.style.width = circle.style.height = `${diameter}px`;
          circle.style.left = `${
            e.clientX - button.getBoundingClientRect().left - radius
          }px`;
          circle.style.top = `${
            e.clientY - button.getBoundingClientRect().top - radius
          }px`;
          circle.classList.add("ripple");
          button.querySelector(".ripple")?.remove();
          button.appendChild(circle);
        }
      });

      async function tambahArtikel() {
        const judul = document.getElementById("judul").value.trim();
        const konten = document.getElementById("konten").value.trim();
        const gambar = document.getElementById("gambar").files[0];

        if (!judul || !konten) {
          alert("Judul dan konten tidak boleh kosong.");
          return;
        }

        let gambarUrl = null;
        if (gambar) {
          const { data, error } = await supabase.storage
            .from("images")
            .upload(`artikels/${gambar.name}`, gambar);
          if (error) {
            alert("Gagal mengupload gambar.");
            console.error(error);
            return;
          }
          gambarUrl = `${supabaseUrl}/storage/v1/object/public/images/artikels/${gambar.name}`;
        }

<<<<<<< HEAD
        try {
          const res = await fetch("http://127.0.0.1:8000/api/artikel/tambah", {
            method: "POST",
            body: formData,
          });
=======
        const { data, error } = await supabase
          .from("artikels")
          .insert([{ judul, konten, gambar_url: gambarUrl }]);
>>>>>>> 7a4a3dba130254a4a0716375a9ac214cf6940edb

        if (error) {
          alert("Gagal menambahkan artikel");
          console.error(error);
        } else {
          alert("Artikel berhasil ditambahkan!");
          document.getElementById("judul").value = "";
          document.getElementById("konten").value = "";
          document.getElementById("gambar").value = "";
          loadArtikel();
        }
      }

<<<<<<< HEAD
async function loadArtikel() {
  try {
    const res = await fetch("http://127.0.0.1:8000/api/articles");
    const container = document.getElementById("daftar-artikel");
    container.innerHTML = "";
=======
      async function loadArtikel() {
        try {
          const { data, error } = await supabase.from("artikels").select("*");
>>>>>>> 7a4a3dba130254a4a0716375a9ac214cf6940edb

          const container = document.getElementById("daftar-artikel");
          container.innerHTML = "";

          if (error) {
            throw new Error("Gagal memuat artikel");
          }

          if (!Array.isArray(data) || data.length === 0) {
            container.innerHTML = `<p class="text-gray-500 italic">Belum ada artikel.</p>`;
            return;
          }

          data.forEach((artikel) => {
            const card = document.createElement("div");
            card.className = "card bg-white p-4 rounded-lg shadow space-y-2";
            card.innerHTML = `
              <h3 class="text-xl font-semibold text-gray-800">${
                artikel.judul
              }</h3>
              ${
                artikel.gambar_url
                  ? `<img src="${artikel.gambar_url}" alt="${artikel.judul}" class="w-full h-auto rounded-md" />`
                  : ""
              }
              <p class="text-gray-600">${artikel.konten}</p>
            `;
            container.appendChild(card);
          });
        } catch (error) {
          const container = document.getElementById("daftar-artikel");
          container.innerHTML = `<p class="text-red-500 italic">Terjadi kesalahan saat memuat artikel.</p>`;
          console.error("Gagal memuat artikel:", error);
        }
      }

      window.onload = loadArtikel;
    </script>
  </body>
</html>
